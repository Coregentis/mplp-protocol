# MPLP æµ‹è¯•ä½“ç³»

æœ¬ç›®å½•åŒ…å« Multi-Agent Project Lifecycle Protocol (MPLP) é¡¹ç›®çš„å®Œæ•´æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿åè®®çš„è´¨é‡ã€ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£
â”œâ”€â”€ setup.js                    # å…¨å±€æµ‹è¯•è®¾ç½®
â”œâ”€â”€ unit/                       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ schema-validation.test.js        # Schema éªŒè¯æµ‹è¯•
â”‚   â”œâ”€â”€ documentation-consistency.test.js # æ–‡æ¡£ä¸€è‡´æ€§æµ‹è¯•
â”‚   â””â”€â”€ translation-quality.test.js      # ç¿»è¯‘è´¨é‡æµ‹è¯•
â””â”€â”€ integration/                # é›†æˆæµ‹è¯•
    â””â”€â”€ system-integration.test.js       # ç³»ç»Ÿé›†æˆæµ‹è¯•
```

## ğŸ§ª æµ‹è¯•ç±»å‹

### å•å…ƒæµ‹è¯• (Unit Tests)

#### Schema éªŒè¯æµ‹è¯•
- **æ–‡ä»¶**: `unit/schema-validation.test.js`
- **ç›®çš„**: éªŒè¯æ‰€æœ‰ JSON Schema æ–‡ä»¶çš„æœ‰æ•ˆæ€§å’Œç¤ºä¾‹æ–‡ä»¶çš„ç¬¦åˆæ€§
- **è¦†ç›–èŒƒå›´**:
  - Schema æ–‡ä»¶å­˜åœ¨æ€§å’Œæœ‰æ•ˆæ€§
  - Schema ç¬¦åˆ JSON Schema è§„èŒƒ
  - ç¤ºä¾‹æ–‡ä»¶ä¸å¯¹åº” Schema çš„åŒ¹é…æ€§
  - Schema ç´¢å¼•æ–‡ä»¶çš„å®Œæ•´æ€§

#### æ–‡æ¡£ä¸€è‡´æ€§æµ‹è¯•
- **æ–‡ä»¶**: `unit/documentation-consistency.test.js`
- **ç›®çš„**: ç¡®ä¿å¤šè¯­è¨€æ–‡æ¡£ç»“æ„å’Œå†…å®¹çš„ä¸€è‡´æ€§
- **è¦†ç›–èŒƒå›´**:
  - å¤šè¯­è¨€ç›®å½•ç»“æ„ä¸€è‡´æ€§
  - åè®®æ¨¡å—æ–‡æ¡£å®Œæ•´æ€§
  - æ–‡æ¡£å†…å®¹ç»“æ„éªŒè¯
  - äº¤å‰å¼•ç”¨æœ‰æ•ˆæ€§

#### ç¿»è¯‘è´¨é‡æµ‹è¯•
- **æ–‡ä»¶**: `unit/translation-quality.test.js`
- **ç›®çš„**: éªŒè¯å¤šè¯­è¨€ç¿»è¯‘çš„å®Œæ•´æ€§å’Œè´¨é‡
- **è¦†ç›–èŒƒå›´**:
  - ç¿»è¯‘å®Œæ•´æ€§æ£€æŸ¥
  - æŠ€æœ¯æœ¯è¯­ä¸€è‡´æ€§
  - ä»£ç ç¤ºä¾‹ä¸€è‡´æ€§
  - è¯­è¨€ç‰¹å®šæ ¼å¼è§„èŒƒ

### é›†æˆæµ‹è¯• (Integration Tests)

#### ç³»ç»Ÿé›†æˆæµ‹è¯•
- **æ–‡ä»¶**: `integration/system-integration.test.js`
- **ç›®çš„**: éªŒè¯æ•´ä¸ªç³»ç»Ÿå„ç»„ä»¶çš„ååŒå·¥ä½œ
- **è¦†ç›–èŒƒå›´**:
  - ç«¯åˆ°ç«¯åè®®éªŒè¯
  - æ–‡æ¡£ä¸ Schema åŒæ­¥æ€§
  - å¤šè¯­è¨€ä¸€è‡´æ€§
  - æ„å»ºå’Œå‘å¸ƒæµç¨‹
  - å¼€å‘å·¥ä½œæµé›†æˆ
  - è´¨é‡ä¿è¯æªæ–½

## ğŸš€ è¿è¡Œæµ‹è¯•

### åŸºæœ¬å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œå•å…ƒæµ‹è¯•
npm run test:unit

# è¿è¡Œé›†æˆæµ‹è¯•
npm run test:integration

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ç›‘è§†æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
npm run test:watch

# CI æ¨¡å¼
npm run test:ci
```

### ä½¿ç”¨æµ‹è¯•è¿è¡Œè„šæœ¬

```bash
# ä½¿ç”¨è‡ªå®šä¹‰æµ‹è¯•è¿è¡Œå™¨
node scripts/run-tests.js [command] [options]

# ç¤ºä¾‹
node scripts/run-tests.js unit --coverage
node scripts/run-tests.js integration --watch
node scripts/run-tests.js all --coverage --ci
node scripts/run-tests.js pre-commit
```

### å¯ç”¨é€‰é¡¹

- `--coverage`: ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
- `--watch`: ç›‘è§†æ–‡ä»¶å˜åŒ–å¹¶è‡ªåŠ¨é‡æ–°è¿è¡Œæµ‹è¯•
- `--ci`: CI æ¨¡å¼ï¼Œé€‚ç”¨äºæŒç»­é›†æˆç¯å¢ƒ
- `--verbose`: è¯¦ç»†è¾“å‡º

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•è¿è¡Œåï¼ŒæŠ¥å‘Šå°†ç”Ÿæˆåœ¨ä»¥ä¸‹ä½ç½®ï¼š

```
build/reports/
â”œâ”€â”€ coverage/                   # è¦†ç›–ç‡æŠ¥å‘Š
â”‚   â”œâ”€â”€ lcov-report/           # HTML è¦†ç›–ç‡æŠ¥å‘Š
â”‚   â”œâ”€â”€ lcov.info              # LCOV æ ¼å¼æŠ¥å‘Š
â”‚   â””â”€â”€ coverage-summary.json  # è¦†ç›–ç‡æ‘˜è¦
â”œâ”€â”€ tests/                     # æµ‹è¯•æŠ¥å‘Š
â”‚   â””â”€â”€ test-results.json      # æµ‹è¯•ç»“æœæ‘˜è¦
â””â”€â”€ jest-html-reporters-attach/ # Jest HTML æŠ¥å‘Š
```

### æŸ¥çœ‹æŠ¥å‘Š

1. **è¦†ç›–ç‡æŠ¥å‘Š**: æ‰“å¼€ `build/reports/coverage/lcov-report/index.html`
2. **æµ‹è¯•æŠ¥å‘Š**: æŸ¥çœ‹ `build/reports/tests/test-results.json`
3. **HTML æµ‹è¯•æŠ¥å‘Š**: æŸ¥çœ‹ `jest-html-reporters-attach/` ç›®å½•ä¸‹çš„ HTML æ–‡ä»¶

## âš™ï¸ é…ç½®

### Jest é…ç½®

æµ‹è¯•é…ç½®ä½äº `config/testing/jest.config.js`ï¼ŒåŒ…å«ï¼š

- **æµ‹è¯•ç¯å¢ƒ**: Node.js
- **æµ‹è¯•æ–‡ä»¶åŒ¹é…**: `**/*.test.js`, `**/*.spec.js`
- **è¦†ç›–ç‡é˜ˆå€¼**: 80%ï¼ˆå…¨å±€ï¼‰
- **è¶…æ—¶è®¾ç½®**: 30ç§’
- **æŠ¥å‘Šç”Ÿæˆ**: HTML å’Œ JSON æ ¼å¼

### å…¨å±€æµ‹è¯•å·¥å…·

`setup.js` æä¾›äº†å…¨å±€æµ‹è¯•å·¥å…· `global.testUtils`ï¼š

```javascript
// è·å–é¡¹ç›®è·¯å¾„
const projectPath = global.testUtils.getProjectPath('docs', 'en');

// è¯»å– JSON æ–‡ä»¶
const data = global.testUtils.readJsonFile(filePath);

// å†™å…¥ JSON æ–‡ä»¶
global.testUtils.writeJsonFile(filePath, data);

// æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
const exists = global.testUtils.fileExists(filePath);

// è·å–ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨
const files = global.testUtils.getFilesInDirectory(dirPath);

// åˆ›å»ºä¸´æ—¶ç›®å½•
const tempDir = global.testUtils.createTempDirectory();

// æ¸…ç†ä¸´æ—¶æ–‡ä»¶
global.testUtils.cleanupTempFiles();
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•

1. **å•å…ƒæµ‹è¯•**: åœ¨ `unit/` ç›®å½•ä¸‹åˆ›å»º `*.test.js` æ–‡ä»¶
2. **é›†æˆæµ‹è¯•**: åœ¨ `integration/` ç›®å½•ä¸‹åˆ›å»º `*.test.js` æ–‡ä»¶
3. **ä½¿ç”¨å…¨å±€å·¥å…·**: åˆ©ç”¨ `global.testUtils` è¿›è¡Œæ–‡ä»¶æ“ä½œ
4. **éµå¾ªå‘½åè§„èŒƒ**: ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°

### æµ‹è¯•æœ€ä½³å®è·µ

1. **ç‹¬ç«‹æ€§**: æ¯ä¸ªæµ‹è¯•åº”è¯¥ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•
2. **æ¸…æ™°æ€§**: æµ‹è¯•åç§°åº”è¯¥æ¸…æ¥šæè¿°æµ‹è¯•çš„ç›®çš„
3. **å®Œæ•´æ€§**: æµ‹è¯•åº”è¯¥è¦†ç›–æ­£å¸¸æƒ…å†µå’Œè¾¹ç•Œæƒ…å†µ
4. **ç»´æŠ¤æ€§**: ä½¿ç”¨è¾…åŠ©å‡½æ•°é¿å…é‡å¤ä»£ç 
5. **æ€§èƒ½**: é¿å…ä¸å¿…è¦çš„æ–‡ä»¶ I/O æ“ä½œ

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµ‹è¯•è¶…æ—¶**: æ£€æŸ¥ `config/testing/jest.config.js` ä¸­çš„ `testTimeout` è®¾ç½®
2. **æ–‡ä»¶è·¯å¾„é—®é¢˜**: ä½¿ç”¨ `global.testUtils.getProjectPath()` è·å–æ­£ç¡®è·¯å¾„
3. **è¦†ç›–ç‡ä¸è¶³**: æ£€æŸ¥ `coverageThreshold` è®¾ç½®å¹¶æ·»åŠ æ›´å¤šæµ‹è¯•
4. **ä¾èµ–é—®é¢˜**: è¿è¡Œ `npm ci` é‡æ–°å®‰è£…ä¾èµ–

## ğŸ”„ æŒç»­é›†æˆ

é¡¹ç›®é…ç½®äº† GitHub Actions å·¥ä½œæµï¼ŒåŒ…å«å¤š Node.js ç‰ˆæœ¬æµ‹è¯•ã€ä»£ç è´¨é‡æ£€æŸ¥ã€å®‰å…¨æ‰«æç­‰ã€‚

### é¢„æäº¤æ£€æŸ¥

```bash
node scripts/run-tests.js pre-commit
```

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡

- **è¦†ç›–ç‡ç›®æ ‡**: â‰¥ 80%ï¼ˆè¡Œã€å‡½æ•°ã€åˆ†æ”¯ã€è¯­å¥ï¼‰
- **æµ‹è¯•é€šè¿‡ç‡**: 100%
- **æ–‡æ¡£è¦†ç›–ç‡**: 100%ï¼ˆæ‰€æœ‰åè®®æ¨¡å—ï¼‰
- **ç¿»è¯‘å®Œæ•´æ€§**: 100%ï¼ˆæ‰€æœ‰æ”¯æŒè¯­è¨€ï¼‰

## æµ‹è¯•è§„èŒƒ

- ä½¿ç”¨ Jest ä½œä¸ºæµ‹è¯•æ¡†æ¶
- æµ‹è¯•æ–‡ä»¶å‘½åï¼š`*.test.js` æˆ– `*.spec.js`
- æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡ï¼šâ‰¥ 80%
- æ‰€æœ‰æ–°åŠŸèƒ½å¿…é¡»åŒ…å«å¯¹åº”æµ‹è¯•